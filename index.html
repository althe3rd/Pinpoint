<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pinpoint Bookmarklet</title>
    
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon_io/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="192x192" href="favicon_io/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="favicon_io/android-chrome-512x512.png">
    <link rel="manifest" href="favicon_io/site.webmanifest">
    <link rel="shortcut icon" href="favicon_io/favicon.ico">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
            min-height: 100vh;
        }
        
        .header {
            background: #c5050c;
            color: white;
            padding: 2rem 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .card {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border-left: 4px solid #c5050c;
        }
        
        .card h2 {
            color: #c5050c;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }
        
        .card h3 {
            color: #333;
            margin: 1.5rem 0 1rem 0;
            font-size: 1.2rem;
        }
        
        .bookmarklet-container {
            background: #f8f9fa;
            border: 2px dashed #c5050c;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            text-align: center;
        }
        
        .bookmarklet {
            display: inline-block;
            background: #c5050c;
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 6px;
            font-weight: bold;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            cursor: grab;
            margin: 0.5rem;
        }
        
        .bookmarklet:hover {
            background: #a00408;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(197, 5, 12, 0.3);
        }
        
        .bookmarklet:active {
            cursor: grabbing;
        }
        
        .generate-btn {
            background: #115421;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0.5rem;
        }
        
        .generate-btn:hover {
            background: #218838;
            transform: translateY(-1px);
        }
        
        .instruction-list {
            background: #e3f2fd;
            border-radius: 6px;
            padding: 1.5rem;
            margin: 1rem 0;
        }
        
        .instruction-list ol {
            padding-left: 1.5rem;
        }
        
        .instruction-list li {
            margin-bottom: 0.8rem;
            font-weight: 500;
        }
        
        .alert {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .alert.info {
            background: #d1ecf1;
            border-color: #bee5eb;
            color: #0c5460;
        }
        
        .alert.success {
            background: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        
        .footer {
            background: #333;
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 3rem;
        }
        
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        .hidden {
            display: none;
        }
        
        .code-display {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 1rem;
            border-radius: 5px;
            font-family: monospace;
            font-size: 0.9rem;
            margin: 1rem 0;
            word-break: break-all;
            max-height: 200px;
            overflow-y: auto;
        }

        .feature-highlight {
            background: #e8f5e8;
            border: 1px solid #c3e6cb;
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .feature-highlight h4 {
            color: #155724;
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Pinpoint</h1>
        <p>Digital Accessibility Testing Tool</p>
    </div>
    <main>
    <div class="container">
        <div class="card">
            <h2>About This Tool</h2>
            <p>Pinpoint is a bookmarklet powered by <strong>axe-core</strong>, the industry-standard accessibility testing engine. This tool provides comprehensive WCAG 2.1 AA compliance testing with a detailed sidebar showing violations, recommendations, and fix suggestions.</p>
            
            <!--<div class="feature-highlight">
                <h4>New Enhanced Features!</h4>
                <ul>
                    <li><strong>Accessibility Score:</strong> Get an instant 0-100 accessibility rating</li>
                    <li><strong>Detailed Technical Information:</strong> Color values, line numbers, and CSS selectors</li>
                    <li><strong>Expandable Details:</strong> Click "Show details" on any issue for in-depth information</li>
                    <li><strong>Visual Score Indicator:</strong> Color-coded circular progress indicator</li>
                </ul>
            </div>-->
            
            <div class="alert info">
                <strong>Powered by axe-core:</strong> Uses the same accessibility testing engine that powers popular tools throughout the industry, ensuring consistent and accurate results.
            </div>
        </div>
        
        <div class="card">
            <h2>Get Your Enhanced Bookmarklet</h2>
            
            <div class="bookmarklet-container">
                <h3>Option 1: Drag & Drop (Recommended)</h3>
                <p>Drag this button directly to your bookmarks bar:</p>
                <a href="#" id="bookmarklet-link" class="bookmarklet">Pinpoint A11y Checker</a>
                <p style="margin-top: 0.5rem; font-size: 0.9rem; color: #666;">
                    Right-click and "Bookmark this link" if drag & drop doesn't work
                </p>
            </div>
            
            <div class="bookmarklet-container">
                <h3>Option 2: Copy & Paste</h3>
                <p>Generate the bookmarklet code to copy manually:</p>
                <button class="generate-btn" onclick="generateBookmarklet()">Generate Enhanced Bookmarklet Code</button>
                <div id="bookmarklet-code" class="code-display hidden"></div>
                <p style="margin-top: 0.5rem; font-size: 0.9rem; color: #666;">
                    Copy this code and paste it as the URL when creating a new bookmark
                </p>
            </div>
            
            <div class="instruction-list">
                <h3>Installation Steps:</h3>
                <ol>
                    <li><strong>Show bookmarks bar:</strong> Press <code>Ctrl+Shift+B</code> (Windows) or <code>Cmd+Shift+B</code> (Mac)</li>
                    <li><strong>Add bookmark:</strong> Either drag the button above OR copy the generated code and create a new bookmark</li>
                    <li><strong>Name it:</strong> "Pinpoint A11y Checker" when creating the bookmark</li>
                    <li><strong>Test it:</strong> Visit any webpage and click your new bookmark</li>
                </ol>
            </div>
            
            <div class="alert success">
                <strong>Ready to use!</strong> The enhanced bookmarklet now shows an accessibility score, detailed technical information, and improved issue analysis.
            </div>
        </div>
        
        <div class="card">
            <h2>What You'll Get</h2>
            <ul style="padding-left: 1.5rem; margin: 1rem 0;">
                <li><strong>Accessibility Score:</strong> 0-100 rating with color-coded visual indicator</li>
                <li><strong>Detailed Sidebar:</strong> Professional interface showing all accessibility issues</li>
                <li><strong>Technical Details:</strong> HTML source, line numbers, CSS selectors, and color information</li>
                <li><strong>Violations & Warnings:</strong> Clear categorization of must-fix issues vs. manual review items</li>
                <li><strong>Click-to-Highlight:</strong> Click any issue to highlight the problematic element on the page</li>
                <li><strong>Enhanced Color Information:</strong> See actual foreground/background colors and contrast ratios</li>
                <li><strong>Fix Recommendations:</strong> Specific guidance on how to resolve each issue</li>
                <li><strong>WCAG Compliance:</strong> Tests against WCAG 2.1 AA standards</li>
                <li><strong>Impact Levels:</strong> Issues categorized by severity (critical, serious, moderate, minor)</li>
                <li><strong>Learn More Links:</strong> Direct links to axe-core documentation for each rule</li>
            </ul>
        </div>
        
        <div class="card">
            <h2>For Local Development</h2>
            <div class="alert">
                <strong>Testing Locally?</strong> If you're testing on localhost or file:// URLs, the CDN version might not work due to CORS restrictions. For local development, consider setting up a local web server.
            </div>
            
            <p><strong>Quick local server options:</strong></p>
            <ul style="padding-left: 1.5rem; margin: 0.5rem 0;">
                <li>Python: <code>python -m http.server 8000</code></li>
                <li>Node.js: <code>npx http-server</code></li>
                <li>PHP: <code>php -S localhost:8000</code></li>
            </ul>
        </div>
        
        <div class="card">
            <h2>Best Practices</h2>
            <ul style="padding-left: 1.5rem;">
                <li>Run accessibility checks on all pages before publishing</li>
                <li>Aim for scores of 90+ for excellent accessibility</li>
                <li>Fix all violations and address manual review items</li>
                <li>Use the detailed technical information to understand issues better</li>
                <li>Test keyboard navigation manually</li>
                <li>Verify with screen readers when possible</li>
                <li>Remember: automated testing catches ~30% of issues - manual testing is still essential</li>
            </ul>
        </div>
    </div>
</main>
    <div class="footer">
        
        <p style="margin-top: 1rem; font-size: 0.9rem; opacity: 0.8;">
            Powered by axe-core accessibility testing engine
        </p>
    </div>
    
    <script>
        // The enhanced bookmarklet code with scoring and detailed information
        const bookmarkletCode = `!function(){"use strict";window.uwAccessibilityChecker?window.uwAccessibilityChecker.remove():(window.uwAccessibilityChecker={version:"1.3.6",issues:[],axeLoaded:!1,checkedItems:new Set,isMinimized:!1,init:function(){this.checkForUpdates(),this.showLoadingPanel(),this.loadAxeCore()},showLoadingPanel:function(){const e=document.createElement("div");e.id="uw-a11y-panel",e.innerHTML='\\n <div id="uw-a11y-header">\\n <div class="uw-a11y-title-container">\\n <img src="images/radial.png" alt="Pinpoint logo" class="uw-a11y-logo">\\n <h2>Pinpoint Accessibility Checker</h2>\\n </div>\\n <button id="uw-a11y-close">‚úï</button>\\n </div>\\n <div id="uw-a11y-content">\\n <div style="text-align: center; padding: 2rem;">\\n <div class="uw-a11y-spinner"></div>\\n <p style="margin-top: 1rem;">Loading axe-core accessibility engine...</p>\\n <p style="font-size: 0.9rem; color: #666;">This may take a few seconds on first use.</p>\\n </div>\\n </div>\\n ',this.addStyles(),document.body.appendChild(e),document.getElementById("uw-a11y-close").onclick=()=>this.remove()},loadAxeCore:function(){if(window.axe)return this.axeLoaded=!0,void this.runAxeChecks();const e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/axe-core@4.8.2/axe.min.js",e.onload=()=>{this.axeLoaded=!0,this.runAxeChecks()},e.onerror=()=>{this.showError("Failed to load axe-core. Please check your internet connection and try again.")},document.head.appendChild(e)},runAxeChecks:function(){if(!window.axe)return void this.showError("axe-core failed to load properly.");window.axe.run(document,{rules:{region:{enabled:!1},"color-contrast-enhanced":{enabled:!1}},tags:["wcag2a","wcag2aa","wcag21aa"],exclude:["#uw-a11y-panel",".uw-a11y-highlight"]},(e,n)=>{e?this.showError("Error running accessibility analysis: "+e.message):(this.processAxeResults(n),this.displayResults())})},processAxeResults:function(e){this.issues=[],this.loadCheckedItems(),e.violations.forEach(e=>{e.nodes.forEach(n=>{this.isOwnUIElement(n)||this.addIssue("error",e.description,this.buildDescription(e,n),this.getElementFromNode(n),this.buildRecommendation(e,n),e.helpUrl,e.impact||"serious",e.tags,this.buildDetailedInfo(e,n),e.id)})}),console.log("Axe incomplete results:",e.incomplete),console.log("Number of incomplete rules:",e.incomplete.length),e.incomplete.forEach((e,n)=>{console.log(\`Incomplete rule \${n}: \${e.id} with \${e.nodes.length} nodes\`),e.nodes.forEach((t,i)=>{if(this.isOwnUIElement(t))return;const a=\`incomplete-\${n}-\${i}\`;this.addIssue("warning",e.description,"Manual review needed: "+this.buildDescription(e,t),this.getElementFromNode(t),this.buildRecommendation(e,t),e.helpUrl,e.impact||"moderate",e.tags,this.buildDetailedInfo(e,t),e.id),this.issues[this.issues.length-1].uniqueId=a})}),this.originalAxeResults=e;const n={...e,violations:e.violations.map(e=>({...e,nodes:e.nodes.filter(e=>!this.isOwnUIElement(e))})).filter(e=>e.nodes.length>0),incomplete:e.incomplete.map(e=>({...e,nodes:e.nodes.filter(e=>!this.isOwnUIElement(e))})).filter(e=>e.nodes.length>0)};this.axeResults={url:e.url,timestamp:e.timestamp,toolOptions:e.toolOptions,violations:n.violations.length,passes:e.passes.length,incomplete:n.incomplete.length,inapplicable:e.inapplicable.length,score:this.calculateAccessibilityScore(n)},this.filteredAxeResults=n},buildDescription:function(e,n){let t=e.help||e.description;return n.failureSummary&&(t+="\\n\\nDetails: "+n.failureSummary),n.html&&(t+="\\n\\nElement: "+n.html.substring(0,100),n.html.length>100&&(t+="...")),t},buildRecommendation:function(e,n){const t=e.id,i=this.getActionableRecommendations();let a="";if(i[t]){const o=i[t];a="function"==typeof o?o(n,e):o}else a=e.help||"Please refer to the help documentation for specific guidance on fixing this issue.";return this.formatRecommendation(a)},formatRecommendation:function(e){return e.replace(/(<[^>]+>)/g,e=>{return\`<code>\${n=e,n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}</code>\`;var n}).replace(/([\\w-]+="[^"]*")/g,e=>e.includes("&lt;")||e.includes("&gt;")?e:\`<code>\${e}</code>\`).replace(/(\\d+(?:\\.\\d+)?:\\d+(?:\\.\\d+)?|tabindex="\\d+"|role="[^"]*"|#[a-zA-Z0-9-]+)/g,e=>e.includes("&lt;")||e.includes("&gt;")?e:\`<code>\${e}</code>\`)},getActionableRecommendations:function(){return{"image-alt":e=>{const n=this.getElementFromNode(e);return n&&"IMG"===n.tagName?n.src&&n.src.includes("decorative")||"presentation"===n.getAttribute("role")?'Add alt="" for decorative images, or add role="presentation" if the image is purely decorative.':'Add descriptive alt text: <img src="..." alt="Brief description of what the image shows or its purpose">. Describe the content and function, not just "image of..."':"Add appropriate alt text describing the image content and purpose."},"image-redundant-alt":'Remove redundant words like "image of", "picture of", "graphic of" from alt text. Just describe what the image shows: alt="Red sports car" instead of alt="Image of a red sports car"',label:e=>{const n=this.getElementFromNode(e);if(n){const e=n.id||"unique-id",t=n.type||"text";return\`Add a label: <label for="\${e}">Field Name</label><input type="\${t}" id="\${e}"> OR use aria-label: <input type="\${t}" aria-label="Field Name">\`}return"Associate each form control with a descriptive label using <label> or aria-label."},"button-name":e=>{const n=this.getElementFromNode(e);return n?""===n.innerHTML.trim()?'Add text content inside the button: <button>Submit Form</button> OR add aria-label: <button aria-label="Submit form">üëç</button>':"Ensure button has accessible text via text content, aria-label, or aria-labelledby.":"Buttons need accessible names - add text content or aria-label."},"duplicate-id":"Make each ID unique. Find duplicate IDs in your HTML and rename them. Each ID must be used only once per page.","color-contrast":e=>{const n=this.extractColorContrastInfo(e);return n?\`Current contrast is \${n.contrast}. WCAG AA requires 4.5:1 for normal text, 3:1 for large text (18pt+ or 14pt+ bold). Try: 1) Darker text color, 2) Lighter background, 3) Use online contrast checker tools.\`:"Improve text contrast ratio. Use darker text on light backgrounds or lighter text on dark backgrounds."},"link-name":'Make link text descriptive. Instead of "click here" or "read more", use "Download annual report" or "Read more about accessibility testing". The link text should make sense out of context.',"link-in-text-block":"Links in text need visual distinction beyond color alone. Add underlines, bold text, or other visual indicators that work for colorblind users.","heading-order":e=>{const n=this.getElementFromNode(e);if(n){const e=parseInt(n.tagName.charAt(1));return\`Fix heading sequence - don't skip levels. After H\${e-2}, use H\${e-1}, not H\${e}. Structure should be H1‚ÜíH2‚ÜíH3, not H1‚ÜíH3.\`}return"Use headings in sequential order (H1, H2, H3...) without skipping levels. Think of headings as a document outline."},"empty-heading":"Add meaningful text inside headings. Remove empty headings or add descriptive content: <h2>Our Services</h2>","aria-allowed-attr":"Remove unsupported ARIA attributes from this element type. Check the ARIA specification for which attributes are valid for each element.","aria-required-attr":'Add required ARIA attributes. For example, role="button" needs aria-label or text content. Check ARIA patterns for required attributes.',"aria-valid-attr-value":'Fix ARIA attribute values. Use valid values like aria-expanded="true" or "false", not "yes" or other invalid values.',"button-name":"Add accessible name to button using text content, aria-label, or aria-labelledby.","table-fake-caption":"Use proper <caption> element instead of fake caption. Move the caption text inside: <table><caption>Sales Data 2024</caption><tr>...</table>","td-headers-attr":'Add headers attribute to complex table cells: <td headers="row1 col2">Data</td> where "row1 col2" are IDs of header cells.',"th-has-data-cells":"Ensure table headers (th) actually relate to data cells. Remove empty or irrelevant header cells.",region:'Add landmark regions using HTML5 elements: <main>, <nav>, <aside>, <header>, <footer>. OR use ARIA: <div role="main">, <div role="navigation">.',"page-has-heading-one":"Add exactly one H1 heading per page. The H1 should describe the main content: <h1>Page Title</h1>","landmark-one-main":'Add one <main> element per page: <main>\\x3c!-- main content here --\\x3e</main> OR <div role="main">',list:"Use proper list markup. Wrap list items in <ul> or <ol>: <ul><li>Item 1</li><li>Item 2</li></ul>","definition-list":"Use proper definition list structure: <dl><dt>Term</dt><dd>Definition</dd></dl>","focus-order-semantics":"Use semantic HTML elements (button, a, input) instead of div/span with click handlers. This ensures proper keyboard focus order.",tabindex:'Remove positive tabindex values (tabindex="1", "2", etc). Use tabindex="0" to make elements focusable or tabindex="-1" to remove from tab order.',"html-has-lang":'Add language attribute to html element: <html lang="en"> or <html lang="es"> for Spanish, etc.',"html-lang-valid":'Use valid language code. Examples: "en" for English, "es" for Spanish, "fr" for French. Use format like "en-US" for regional variants.',"audio-caption":"Add captions to audio content using <track> element with captions file, or provide transcript nearby.","video-caption":'Add captions: <video><track kind="captions" src="captions.vtt" srclang="en" label="English"></video>',"meta-refresh":'Remove auto-refresh meta tags. Use JavaScript with user control: <button onclick="refresh()">Refresh Page</button>',"meta-viewport":'Add viewport meta tag: <meta name="viewport" content="width=device-width, initial-scale=1.0">',"duplicate-id-active":"Remove duplicate IDs from interactive elements. Each ID must be unique across the entire page.","duplicate-id-aria":"Fix duplicate IDs used in ARIA relationships (aria-labelledby, aria-describedby). Each referenced ID must be unique.","frame-title":'Add descriptive title to iframe: <iframe title="Customer feedback form" src="..."></iframe>',"object-alt":'Add alternative text to object elements: <object data="chart.svg" type="image/svg+xml">Sales chart showing 20% increase</object>',"scope-attr-valid":'Use valid scope attribute values on table headers: scope="col" for column headers, scope="row" for row headers.',"skip-link":'Add skip navigation link at page start: <a href="#main" class="skip-link">Skip to main content</a>',"css-orientation-lock":"Don't lock orientation in CSS. Remove or modify CSS that prevents rotation: transform: rotate() or orientation locks."}},getElementFromNode:function(e){if(e.target&&e.target.length>0)try{return document.querySelector(e.target[0])}catch(e){return null}return null},isOwnUIElement:function(e){if(e.target&&e.target[0]){const n=e.target[0];if(n.includes("#uw-a11y-panel")||n.includes("uw-a11y-"))return!0}if(e.html&&(e.html.includes("uw-a11y-")||e.html.includes('id="uw-a11y-')))return!0;const n=this.getElementFromNode(e);if(n){const e=document.getElementById("uw-a11y-panel");if(e&&(n===e||e.contains(n)))return!0;if(n.className&&"string"==typeof n.className&&n.className.includes("uw-a11y-"))return!0;if(n.id&&n.id.includes("uw-a11y-"))return!0}return!1},buildDetailedInfo:function(e,n){const t=[];if(n.html){t.push({type:"html",label:"HTML Source",value:n.html});const e=this.estimateLineNumber(n.html);e>0&&t.push({type:"line",label:"Approximate Line",value:e})}if(n.target&&n.target[0]&&t.push({type:"selector",label:"CSS Selector",value:n.target[0]}),"color-contrast"===e.id){const e=this.extractColorContrastInfo(n);e&&t.push({type:"colors",label:"Color Information",value:e})}if((e.id.includes("landmark")||e.id.includes("region"))&&t.push({type:"landmarks",label:"Landmark Context",value:this.analyzeLandmarkContext(n)}),e.id.includes("heading")&&t.push({type:"headings",label:"Heading Structure",value:this.analyzeHeadingStructure(n)}),n.failureSummary&&t.push({type:"failure",label:"Technical Details",value:n.failureSummary}),n.any&&n.any.length>0){const e=n.any.map(e=>e.message||e.id).filter(Boolean);e.length>0&&t.push({type:"checks",label:"Failed Checks",value:e.join(", ")})}return t},estimateLineNumber:function(e){try{const n=document.documentElement.outerHTML,t=n.indexOf(e.substring(0,50));if(t>-1){return n.substring(0,t).split("\\n").length}}catch(e){}return 0},extractColorContrastInfo:function(e){try{const n=this.getElementFromNode(e);if(!n)return null;const t=window.getComputedStyle(n);let i=t.color,a=t.backgroundColor;if(!a||"transparent"===a||"rgba(0, 0, 0, 0)"===a||a.includes("rgba(0, 0, 0, 0)")){let e=n.parentElement;for(;e&&e!==document.body;){const n=window.getComputedStyle(e).backgroundColor;if(n&&"transparent"!==n&&"rgba(0, 0, 0, 0)"!==n&&!n.includes("rgba(0, 0, 0, 0)")){a=n;break}e=e.parentElement}a&&"transparent"!==a&&"rgba(0, 0, 0, 0)"!==a&&!a.includes("rgba(0, 0, 0, 0)")||(a="#ffffff")}const o=this.calculateContrastRatio(i,a);return{foreground:i,background:a,contrast:o?o.toFixed(2)+":1":"Unable to calculate",required:"WCAG AA requires 4.5:1 for normal text, 3:1 for large text"}}catch(e){return console.warn("Error extracting color contrast info:",e),null}},calculateContrastRatio:function(e,n){try{const t=this.getLuminance(e),i=this.getLuminance(n);if(null===t||null===i)return console.warn("Could not calculate luminance for colors:",e,n),null;const a=Math.max(t,i),o=(a+.05)/(Math.min(t,i)+.05);return isNaN(o)||!isFinite(o)?(console.warn("Invalid contrast ratio calculated for colors:",e,n),null):o}catch(e){return console.warn("Error calculating contrast ratio:",e),null}},getLuminance:function(e){try{let n,t,i;if(e.startsWith("#")){const a=e.slice(1);if(3===a.length)n=parseInt(a[0]+a[0],16),t=parseInt(a[1]+a[1],16),i=parseInt(a[2]+a[2],16);else{if(6!==a.length)return null;n=parseInt(a.slice(0,2),16),t=parseInt(a.slice(2,4),16),i=parseInt(a.slice(4,6),16)}}else if(e.startsWith("rgb")){const a=e.match(/\\d+/g);if(!a||3>a.length)return null;n=parseInt(a[0]),t=parseInt(a[1]),i=parseInt(a[2])}else{const a={white:[255,255,255],black:[0,0,0],red:[255,0,0],green:[0,128,0],blue:[0,0,255],yellow:[255,255,0],cyan:[0,255,255],magenta:[255,0,255],silver:[192,192,192],gray:[128,128,128],grey:[128,128,128]},o=e.toLowerCase().trim();if(!a[o])return null;[n,t,i]=a[o]}const a=e=>(e/=255)>.03928?Math.pow((e+.055)/1.055,2.4):e/12.92,o=a(n),s=a(t);return.2126*o+.7152*s+.0722*a(i)}catch(n){return console.warn("Error calculating luminance for color:",e,n),null}},analyzeLandmarkContext:function(e){try{const n=this.getElementFromNode(e);if(!n)return"Element not found";return\`Found \${document.querySelectorAll('main, nav, header, footer, aside, section[aria-label], section[aria-labelledby], [role="banner"], [role="navigation"], [role="main"], [role="contentinfo"], [role="complementary"]').length} landmarks on page. Current element: \${n.tagName.toLowerCase()}\${n.getAttribute("role")?' (role="'+n.getAttribute("role")+'")':""}\`}catch(e){return"Unable to analyze landmark context"}},analyzeHeadingStructure:function(e){try{const n=this.getElementFromNode(e);if(!n)return"Element not found";const t=Array.from(document.querySelectorAll("h1, h2, h3, h4, h5, h6")),i=t.indexOf(n),a=parseInt(n.tagName.charAt(1));let o=\`Current: \${n.tagName} "\${n.textContent.substring(0,50)}"\`;if(i>0){const e=t[i-1],n=parseInt(e.tagName.charAt(1));o+=\`\\nPrevious: \${e.tagName} (level \${n})\`,a>n+1&&(o+=\`\\nIssue: Skipped from H\${n} to H\${a}\`)}return o}catch(e){return"Unable to analyze heading structure"}},calculateAccessibilityScore:function(e){const n={critical:10,serious:7,moderate:3,minor:1};let t=0,i=e.passes.length+e.violations.length+e.incomplete.length;e.violations.forEach(e=>{t+=e.nodes.length*(n[e.impact]||n.moderate)});let a=0,o=0,s=0;if(e.incomplete.forEach((e,t)=>{e.nodes.forEach((i,r)=>{o++;if(this.checkedItems&&this.checkedItems.has(\`incomplete-\${t}-\${r}\`))s++;else{a+=.5*(n[e.impact]||n.moderate)}})}),t+=a,0===i)return{score:100,deductions:0,maxPossible:0,verifiedCount:0,totalManualReview:0};const r=i*n.critical;return{score:Math.max(0,Math.round(100-t/r*100)),deductions:t,maxPossible:r,verifiedCount:s,totalManualReview:o,details:{violations:e.violations.length,incomplete:e.incomplete.length,passes:e.passes.length}}},showError:function(e){const n=document.getElementById("uw-a11y-panel");if(n){n.querySelector("#uw-a11y-content").innerHTML=\`\\n <div class="uw-a11y-issue error" style="margin: 1rem;">\\n <h4>Error Loading Accessibility Checker</h4>\\n <p>\${e}</p>\\n <p><strong>Suggestions:</strong></p>\\n <ul>\\n <li>Check your internet connection</li>\\n <li>Try refreshing the page and running the bookmarklet again</li>\\n <li>Ensure your browser allows loading external scripts</li>\\n </ul>\\n </div>\\n \`}},createPanel:function(){let e=document.getElementById("uw-a11y-panel");return e||(e=document.createElement("div"),e.id="uw-a11y-panel",document.body.appendChild(e)),e.innerHTML='\\n <div id="uw-a11y-header">\\n <div class="uw-a11y-title-container">\\n <img src="images/radial.png" alt="Pinpoint logo" class="uw-a11y-logo">\\n <h2>Pinpoint Accessibility Checker</h2>\\n </div>\\n <div class="uw-a11y-header-buttons">\\n <button id="uw-a11y-minimize" title="Minimize">‚àí</button>\\n <button id="uw-a11y-close" title="Close">‚úï</button>\\n </div>\\n </div>\\n <div id="uw-a11y-content">\\n <div id="uw-a11y-summary"></div>\\n <div id="uw-a11y-results"></div>\\n </div>\\n ',document.getElementById("uw-a11y-close").onclick=()=>this.remove(),document.getElementById("uw-a11y-minimize").onclick=()=>this.toggleMinimize(),e},addStyles:function(){if(document.getElementById("uw-a11y-styles"))return;const e=document.createElement("style");e.id="uw-a11y-styles",e.textContent="\\n @import url('https://fonts.googleapis.com/css2?family=Red+Hat+Display:ital,wght@0,300..900;1,300..900&family=Red+Hat+Text:ital,wght@0,300..900;1,300..900&display=swap');\\n\\n body #uw-a11y-panel {\\n position: fixed;\\n top: 20px;\\n right: 20px;\\n width: 450px;\\n max-height: 85vh;\\n background: rgba(255,255,255,0.8);\\n border: 1px solid rgba(255,255,255,0.85);\\n border-radius: 12px;\\n backdrop-filter: blur(12px);\\n box-shadow: 0 8px 32px rgba(0,0,0,0.3);\\n z-index: 999999;\\n font-family: \\"Red Hat Display\\", \\"Red Hat Text\\", Arial, sans-serif;\\n font-size: 14px;\\n overflow: hidden;\\n transition: all 0.3s ease;\\n \\n }\\n \\n body #uw-a11y-panel.minimized {\\n bottom: -1px;\\n top: auto;\\n right: 20px;\\n width: 400px;\\n max-height: 180px;\\n border-radius: 8px 8px 0 0;\\n }\\n\\n \\n \\n body #uw-a11y-panel.minimized #uw-a11y-content {\\n max-height: 120px;\\n padding: 8px 16px;\\n display: none;\\n }\\n \\n body #uw-a11y-panel.minimized #uw-a11y-results {\\n display: none;\\n }\\n \\n body #uw-a11y-panel.minimized .uw-a11y-score-container {\\n margin: 0.5rem 0;\\n padding: 0.5rem;\\n }\\n \\n body #uw-a11y-panel.minimized .uw-a11y-score-dial {\\n width: 60px;\\n height: 60px;\\n }\\n \\n body #uw-a11y-panel.minimized .uw-a11y-score-circle {\\n width: 60px;\\n height: 60px;\\n }\\n \\n body #uw-a11y-panel.minimized .uw-a11y-score-inner {\\n width: 45px;\\n height: 45px;\\n }\\n \\n body #uw-a11y-panel.minimized .uw-a11y-score-number {\\n font-size: 16px;\\n }\\n \\n body #uw-a11y-panel.minimized .uw-a11y-score-label {\\n font-size: 8px;\\n }\\n \\n body #uw-a11y-panel.minimized h3 {\\n font-size: 14px;\\n margin-bottom: 0.5rem;\\n }\\n \\n body #uw-a11y-panel.minimized #uw-a11y-minimize {\\n transform: rotate(180deg);\\n }\\n body #uw-a11y-panel #uw-a11y-header {\\n \\n color: #000;\\n padding: 12px 16px;\\n display: flex;\\n justify-content: space-between;\\n align-items: center;\\n cursor: default;\\n }\\n \\n body #uw-a11y-panel #uw-a11y-header:active {\\n \\n }\\n \\n body #uw-a11y-panel .uw-a11y-header-buttons {\\n display: flex;\\n gap: 8px;\\n }\\n body #uw-a11y-panel .uw-a11y-title-container {\\n display: flex;\\n align-items: center;\\n gap: 8px;\\n }\\n \\n body #uw-a11y-panel .uw-a11y-logo {\\n width: 20px;\\n height: 20px;\\n flex-shrink: 0;\\n }\\n \\n body #uw-a11y-panel #uw-a11y-header h2 {\\n margin: 0;\\n font-size: 16px;\\n font-weight: bold;\\n }\\n body #uw-a11y-panel #uw-a11y-close, body #uw-a11y-panel #uw-a11y-minimize {\\n background: none;\\n border: none;\\n color: black;\\n font-size: 18px;\\n cursor: pointer;\\n padding: 0;\\n width: 24px;\\n height: 24px;\\n border-radius: 50%;\\n display: flex;\\n align-items: center;\\n justify-content: center;\\n transition: all 0.2s ease;\\n }\\n \\n body #uw-a11y-panel #uw-a11y-close:hover, body #uw-a11y-panel #uw-a11y-minimize:hover {\\n background: rgba(255,255,255,0.2);\\n }\\n \\n body #uw-a11y-panel #uw-a11y-minimize {\\n font-size: 20px;\\n font-weight: bold;\\n }\\n body #uw-a11y-panel #uw-a11y-content {\\n max-height: calc(85vh - 60px);\\n overflow-y: auto;\\n padding: 16px;\\n }\\n body #uw-a11y-panel #uw-a11y-summary {\\n background: #f8f9fa;\\n border: 1px solid #dee2e6;\\n border-radius: 10px;\\n padding: 10px;\\n margin-bottom: 16px;\\n \\n }\\n body #uw-a11y-panel .uw-a11y-issue {\\n margin-bottom: 18px;\\n padding: 12px;\\n border-left: 4px solid #ffc107;\\n background: #fff3cd;\\n border-radius: 8px;\\n cursor: pointer;\\n }\\n body #uw-a11y-panel .uw-a11y-issue.error {\\n border-left-color: #dc3545;\\n background: #f8d7da;\\n box-shadow: 0 2px 10px 0 rgba(211, 23, 41, 0.22);\\n }\\n body #uw-a11y-panel .uw-a11y-issue.warning {\\n border-left-color: #ffc107;\\n background: #fff3cd;\\n box-shadow: 0 2px 10px 0 rgba(211, 133, 23, 0.22);\\n }\\n body #uw-a11y-panel .uw-a11y-issue.info {\\n border-left-color: #17a2b8;\\n background: #d1ecf1;\\n box-shadow: 0 2px 10px 0 rgba(23, 104, 211, 0.22);\\n }\\n body #uw-a11y-panel .uw-a11y-issue h4 {\\n margin: 0 0 8px 0;\\n font-size: 14px;\\n font-weight: bold;\\n }\\n body #uw-a11y-panel .uw-a11y-issue p {\\n margin: 4px 0;\\n line-height: 1.4;\\n }\\n body #uw-a11y-panel .uw-a11y-issue .issue-meta {\\n font-size: 12px;\\n color: #666;\\n margin-top: 8px;\\n padding-top: 8px;\\n border-top: 1px solid rgba(0,0,0,0.1);\\n display: flex;\\n justify-content: space-between;\\n align-items: center;\\n }\\n body #uw-a11y-panel .uw-a11y-issue .learn-more {\\n color: #c5050c;\\n \\n font-size: 12px;\\n }\\n body #uw-a11y-panel .uw-a11y-issue .learn-more:hover {\\n text-decoration: underline;\\n }\\n\\n body #uw-a11y-panel .uw-a11y-issue .how-to-fix {\\n margin-top: 8px;\\n border-radius: 4px;\\n background: rgb(236, 236, 236);\\n padding: 8px;\\n font-size: 12px;\\n color: #212529;\\n font-weight: 500;\\n border-left: 4px solid rgb(51, 141, 214);\\n display: flex;\\n align-items: center;\\n gap: 8px;\\n }\\n\\n body #uw-a11y-panel .uw-a11y-issue .how-to-fix-icon {\\n align-self: flex-start;\\n margin-top: 2px;\\n }\\n\\n body #uw-a11y-panel .uw-a11y-issue .how-to-fix-icon svg {\\n width: 12px;\\n height: 12px;\\n }\\n\\n body .uw-a11y-highlight {\\n background: yellow !important;\\n border: 2px solid red !important;\\n box-shadow: 0 0 0 2px yellow !important;\\n }\\n body #uw-a11y-panel .uw-a11y-count {\\n font-weight: bold;\\n padding: 2px 8px;\\n border-radius: 12px;\\n color: white;\\n font-size: 12px;\\n margin-right: 8px;\\n }\\n body #uw-a11y-panel .count-error { background: #dc3545; }\\n body #uw-a11y-panel .count-warning { background: #ffc107; color: #212529; }\\n body #uw-a11y-panel .count-info { background: #17a2b8; }\\n body #uw-a11y-panel .count-verified { background: #28a745; }\\n body #uw-a11y-panel .uw-a11y-manual-check {\\n margin: 8px 0;\\n padding: 8px;\\n background: #f8f9fa;\\n border-radius: 4px;\\n border: 1px solid #dee2e6;\\n }\\n body #uw-a11y-panel .uw-a11y-checkbox {\\n display: flex;\\n align-items: center;\\n cursor: pointer;\\n font-size: 13px;\\n }\\n body #uw-a11y-panel .uw-a11y-checkbox input[type=\\"checkbox\\"] {\\n margin-right: 8px;\\n width: 16px;\\n height: 16px;\\n }\\n body #uw-a11y-panel .uw-a11y-issue.checked {\\n opacity: 0.7;\\n background: #d4edda !important;\\n border-left-color: #28a745 !important;\\n }\\n body #uw-a11y-panel .uw-a11y-issue.checked .uw-a11y-manual-check {\\n background: #d4edda;\\n border-color: #c3e6cb;\\n }\\n body #uw-a11y-panel .uw-a11y-check-label {\\n color: #155724;\\n font-weight: 500;\\n }\\n body #uw-a11y-panel .uw-a11y-spinner {\\n width: 40px;\\n height: 40px;\\n border: 4px solid #f3f3f3;\\n border-top: 4px solid #c5050c;\\n border-radius: 50%;\\n animation: uw-spin 1s linear infinite;\\n margin: 0 auto;\\n }\\n @keyframes uw-spin {\\n 0% { transform: rotate(0deg); }\\n 100% { transform: rotate(360deg); }\\n }\\n body #uw-a11y-panel .axe-summary {\\n font-size: 12px;\\n color: #666;\\n border-top: 1px solid #dee2e6;\\n padding-top: 12px;\\n margin-top: 12px;\\n }\\n body #uw-a11y-panel .uw-a11y-score-container {\\n text-align: center;\\n margin: 1rem 0;\\n padding: 1rem;\\n background: #f8f9fa;\\n border-radius: 8px;\\n border: 2px solid #e9ecef;\\n }\\n body #uw-a11y-panel .uw-a11y-score-dial {\\n position: relative;\\n width: 120px;\\n height: 120px;\\n margin: 0 auto 1rem auto;\\n }\\n body #uw-a11y-panel .uw-a11y-score-circle {\\n width: 120px;\\n height: 120px;\\n border-radius: 50%;\\n background: conic-gradient(from 0deg, #28a745 0deg 0deg, #e9ecef 0deg 360deg);\\n display: flex;\\n align-items: center;\\n justify-content: center;\\n position: relative;\\n }\\n body #uw-a11y-panel .uw-a11y-score-inner {\\n width: 90px;\\n height: 90px;\\n background: white;\\n border-radius: 50%;\\n display: flex;\\n align-items: center;\\n justify-content: center;\\n flex-direction: column;\\n font-weight: bold;\\n }\\n body #uw-a11y-panel .uw-a11y-score-number {\\n font-size: 24px;\\n color: #333;\\n }\\n body #uw-a11y-panel .uw-a11y-score-label {\\n font-size: 10px;\\n color: #666;\\n text-transform: uppercase;\\n }\\n body #uw-a11y-panel .uw-a11y-details {\\n margin-top: 1rem;\\n padding: 0.5rem;\\n background: #f1f3f4;\\n border-left: 3px solid #007cba;\\n border-radius: 0 4px 4px 0;\\n font-size: 12px;\\n display: none;\\n }\\n body #uw-a11y-panel .uw-a11y-details.expanded {\\n display: block;\\n }\\n body #uw-a11y-panel .uw-a11y-details-toggle {\\n display: block;\\n background: rgba(0,0,0,0.12);\\n border: 1px solid rgba(0,0,0,0.3);\\n border-radius: 50rem;\\n padding: 4px 8px;\\n color:rgb(28, 28, 28);\\n cursor: pointer;\\n font-size: 12px;\\n text-decoration: none;\\n backdrop-filter: saturate(250%);\\n margin-top: 0.5rem;\\n }\\n\\n body #uw-a11y-panel .uw-a11y-details-toggle {\\n display: flex;\\n align-items: center;\\n gap: 8px;\\n }\\n\\n\\n body #uw-a11y-panel .uw-a11y-details-toggle .technical-details-icon {\\n width: 12px;\\n height: 12px;\\n }\\n\\n body #uw-a11y-panel .uw-a11y-details-item {\\n margin: 0.5rem 0;\\n padding: 0.5rem;\\n background: white;\\n border-radius: 3px;\\n }\\n\\n body #uw-a11y-panel .uw-a11y-details-label {\\n font-weight: bold;\\n color: #495057;\\n }\\n body #uw-a11y-panel .uw-a11y-details-value {\\n font-family: monospace;\\n background: #f8f9fa;\\n padding: 0.25rem;\\n border-radius: 2px;\\n margin-top: 0.25rem;\\n word-break: break-all;\\n }\\n body #uw-a11y-panel .uw-a11y-instance-nav {\\n display: flex;\\n justify-content: space-between;\\n align-items: center;\\n margin-top: -12px;\\n margin-left: -12px;\\n margin-right: -12px;\\n margin-bottom: 10px;\\n padding: 8px;\\n background: rgba(0,0,0,0.1);\\n backdrop-filter: saturate(200%);\\n border-top-right-radius: 4px;\\n font-size: 12px;\\n }\\n body #uw-a11y-panel .uw-a11y-instance-count {\\n font-weight: bold;\\n color: #495057;\\n }\\n body #uw-a11y-panel .uw-a11y-nav-buttons {\\n display: flex;\\n gap: 4px;\\n }\\n body #uw-a11y-panel .uw-a11y-nav-buttons button {\\n background:rgba(0,0,0,0.4);\\n backdrop-filter: saturate(200%);\\n color: white;\\n border: none;\\n padding: 4px 8px;\\n border-radius: 3px;\\n font-size: 11px;\\n cursor: pointer;\\n transition: background 0.2s;\\n }\\n body #uw-a11y-panel .uw-a11y-nav-buttons button:hover:not(:disabled) {\\n background:rgba(0,0,0,0.4);\\n }\\n body #uw-a11y-panel .uw-a11y-nav-buttons button:disabled {\\n background:rgba(0,0,0,0.1);\\n cursor: not-allowed;\\n }\\n \\n body #uw-a11y-panel .how-to-fix code {\\n background: #f8f9fa;\\n border: 1px solid #e9ecef;\\n border-radius: 3px;\\n padding: 2px 4px;\\n font-family: 'Consolas', 'Monaco', 'Courier New', monospace;\\n font-size: 12px;\\n color: #e83e8c;\\n font-weight: 600;\\n white-space: nowrap;\\n }\\n \\n body #uw-a11y-panel .how-to-fix code:not(:last-child) {\\n margin-right: 2px;\\n }\\n ",document.head.appendChild(e)},addIssue:function(e,n,t,i,a,o,s,r,l,d){this.issues.push({id:this.issues.length,type:e,title:n,description:t,element:i,recommendation:a,helpUrl:o,impact:s,tags:r||[],detailedInfo:l||[],ruleId:d||n.toLowerCase().replace(/[^a-z0-9]/g,"-")})},displayResults:function(){this.createPanel();const e=document.getElementById("uw-a11y-summary"),n=document.getElementById("uw-a11y-results");this.loadMinimizeState();const t=this.issues.filter(e=>"error"===e.type).length,i=this.issues.filter(e=>"warning"===e.type&&e.uniqueId).length,a=this.issues.filter(e=>"warning"===e.type&&e.uniqueId&&this.checkedItems.has(e.uniqueId)).length,o=(this.issues.filter(e=>"info"===e.type),this.axeResults?this.axeResults.score:null);if(e.innerHTML=\`\\n \${o?this.renderScoreDial(o):""}\\n <h3>axe-core Accessibility Analysis</h3>\\n <p><strong>Total Issues Found:</strong> \${this.issues.length}</p>\\n <div style="margin: 8px 0;">\\n <span class="uw-a11y-count count-error">\${t}</span>Violations\\n <span class="uw-a11y-count count-warning">\${i}</span>Manual Review\\n \${a>0?\`<span class="uw-a11y-count count-verified">\${a}</span>Verified\`:""}\\n </div>\\n <p><small>Click on any issue to highlight the element on the page.</small></p>\\n \${this.axeResults?\`\\n <div class="axe-summary">\\n <strong>Test Summary:</strong> \${this.axeResults.violations} violations, \\n \${this.axeResults.passes} passes, \${this.axeResults.incomplete} need review, \\n \${this.axeResults.inapplicable} not applicable<br>\\n <strong>Standard:</strong> WCAG 2.1 AA | <strong>Engine:</strong> axe-core | <strong>Checker:</strong> v\${this.version}\\n </div>\\n \`:""}\\n \`,0===this.issues.length)n.innerHTML='\\n <div class="uw-a11y-issue info">\\n <h4>Excellent Accessibility!</h4>\\n <p>No accessibility violations detected by axe-core. Your page meets WCAG 2.1 AA automated testing standards.</p>\\n <p><strong>Next Steps:</strong> Consider manual testing with screen readers and keyboard navigation for complete accessibility validation.</p>\\n </div>\\n ';else{const e=this.groupIssuesByRule(this.issues);n.innerHTML=Object.keys(e).map(n=>{const t=e[n],i=t[0],a="warning"===i.type&&i.uniqueId,o=t.length>1?\`\\n <div class="uw-a11y-instance-nav">\\n <span class="uw-a11y-instance-count">Instance <span id="current-\${n}">1</span> of \${t.length}</span>\\n <div class="uw-a11y-nav-buttons">\\n <button onclick="window.uwAccessibilityChecker.navigateInstance('\${n}', -1); event.stopPropagation();" \\n id="prev-\${n}" disabled>‚Äπ Prev</button>\\n <button onclick="window.uwAccessibilityChecker.navigateInstance('\${n}', 1); event.stopPropagation();" \\n id="next-\${n}">Next ‚Ä∫</button>\\n </div>\\n </div>\\n \`:"",s=a?\`<div class="uw-a11y-manual-check">\\n <label class="uw-a11y-checkbox">\\n <input type="checkbox" \\n id="check-\${n}" \\n \${this.isRuleVerified(n)?"checked":""}\\n onchange="window.uwAccessibilityChecker.toggleRuleVerification('\${n}'); event.stopPropagation();">\\n <span class="uw-a11y-checkmark"></span>\\n <span class="uw-a11y-check-label">\\n \${this.isRuleVerified(n)?\`All \${t.length} instances manually verified ‚úì\`:\`Mark all \${t.length} instances as verified\`}\\n </span>\\n </label>\\n </div>\`:"";return\`\\n <div class="uw-a11y-issue \${i.type} \${a&&this.isRuleVerified(n)?"checked":""}" \\n onclick="window.uwAccessibilityChecker.highlightCurrentInstance('\${n}')" \\n style="cursor: pointer" id="issue-\${n}">\\n \${o}\\n <h4>\${i.title} \${t.length>1?\`(\${t.length} instances)\`:""}</h4>\\n \\x3c!--<p id="description-\${n}">\${i.description.split("\\n")[0]}</p>--\\x3e\\n <div class="how-to-fix"><div class="how-to-fix-icon"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M331.8 224.1c28.29 0 54.88 10.99 74.86 30.97l19.59 19.59c40.01-17.74 71.25-53.3 81.62-96.65c5.725-23.92 5.34-47.08 .2148-68.4c-2.613-10.88-16.43-14.51-24.34-6.604l-68.9 68.9h-75.6V97.2l68.9-68.9c7.912-7.912 4.275-21.73-6.604-24.34c-21.32-5.125-44.48-5.51-68.4 .2148c-55.3 13.23-98.39 60.22-107.2 116.4C224.5 128.9 224.2 137 224.3 145l82.78 82.86C315.2 225.1 323.5 224.1 331.8 224.1zM384 278.6c-23.16-23.16-57.57-27.57-85.39-13.9L191.1 158L191.1 95.99l-127.1-95.99L0 63.1l96 127.1l62.04 .0077l106.7 106.6c-13.67 27.82-9.251 62.23 13.91 85.39l117 117.1c14.62 14.5 38.21 14.5 52.71-.0016l52.75-52.75c14.5-14.5 14.5-38.08-.0016-52.71L384 278.6zM227.9 307L168.7 247.9l-148.9 148.9c-26.37 26.37-26.37 69.08 0 95.45C32.96 505.4 50.21 512 67.5 512s34.54-6.592 47.72-19.78l119.1-119.1C225.5 352.3 222.6 329.4 227.9 307zM64 472c-13.25 0-24-10.75-24-24c0-13.26 10.75-24 24-24S88 434.7 88 448C88 461.3 77.25 472 64 472z"/></svg></div><div><strong>How to fix:</strong> <span id="recommendation-\${n}"></span></div></div>\\n \\n \${s}\\n \${i.detailedInfo&&i.detailedInfo.length>0?\`\\n <button class="uw-a11y-details-toggle" onclick="window.uwAccessibilityChecker.toggleDetails('\${n}'); event.stopPropagation();">\\n <div class="technical-details-icon"><svg viewBox="0 0 96 96" xmlns="http://www.w3.org/2000/svg"><title/><g><path d="M24.8452,25.3957a6.0129,6.0129,0,0,0-8.4487.7617L1.3974,44.1563a5.9844,5.9844,0,0,0,0,7.687L16.3965,69.8422a5.9983,5.9983,0,1,0,9.21-7.687L13.8068,48l11.8-14.1554A6,6,0,0,0,24.8452,25.3957Z"/><path d="M55.1714,12.1192A6.0558,6.0558,0,0,0,48.1172,16.83L36.1179,76.8262A5.9847,5.9847,0,0,0,40.8286,83.88a5.7059,5.7059,0,0,0,1.1835.1172A5.9949,5.9949,0,0,0,47.8828,79.17L59.8821,19.1735A5.9848,5.9848,0,0,0,55.1714,12.1192Z"/><path d="M94.6026,44.1563,79.6035,26.1574a5.9983,5.9983,0,1,0-9.21,7.687L82.1932,48l-11.8,14.1554a5.9983,5.9983,0,1,0,9.21,7.687L94.6026,51.8433A5.9844,5.9844,0,0,0,94.6026,44.1563Z"/></g></svg></div>Show technical details\\n </button>\\n <div class="uw-a11y-details" id="details-\${n}">\\n <div id="detailed-content-\${n}">\\n \${this.renderDetailedInfo(i.detailedInfo)}\\n </div>\\n </div>\\n \`:""}\\n <div class="issue-meta">\\n <div><strong>Impact:</strong> \${i.impact||"unknown"}\\n \\n </div>\\n \\x3c!--<strong>Tags:</strong> \${i.tags.join(", ")}--\\x3e\\n \${i.helpUrl?\`<br><a href="\${i.helpUrl}" target="_blank" class="learn-more">Learn more about this rule</a>\`:""}\\n </div>\\n </div>\\n \`}).join(""),Object.keys(e).forEach(n=>{const t=e[n][0],i=document.getElementById(\`recommendation-\${n}\`);i&&(i.innerHTML=t.recommendation)})}},renderScoreDial:function(e){const n=e.score,t=n/100*360;return\`\\n <div class="uw-a11y-score-container">\\n <div class="uw-a11y-score-dial">\\n <div class="uw-a11y-score-circle" style="background: conic-gradient(from 0deg, \${90>n?70>n?50>n?"#dc3545":"#fd7e14":"#ffc107":"#28a745"} 0deg \${t}deg, #e9ecef \${t}deg 360deg);">\\n <div class="uw-a11y-score-inner">\\n <div class="uw-a11y-score-number">\${n}</div>\\n <div class="uw-a11y-score-label">Score</div>\\n </div>\\n </div>\\n </div>\\n <div style="font-size: 14px;">\\n <span style="font-size: 12px; color: #666;">\\n \${97>n?90>n?70>n?50>n?"Immediate attention needed":"Fair accessibility - several issues to address":"Good accessibility with room for improvement":"Very Good - just a few issues to address":"Excellent"}\\n </span>\\n </div>\\n </div>\\n \`},renderDetailedInfo:function(e){return e.map(e=>{let n=e.value;return"colors"===e.type&&"object"==typeof n&&(n=\`\\n <div style="margin: 0.5rem 0;">\\n <div><strong>Foreground:</strong> <span style="background: \${n.foreground}; color: white; padding: 2px 6px; border-radius: 2px;">\${n.foreground}</span></div>\\n <div><strong>Background:</strong> <span style="background: \${n.background}; border: 1px solid #ccc; padding: 2px 6px; border-radius: 2px;">\${n.background}</span></div>\\n <div><strong>Contrast Ratio:</strong> \${n.contrast}</div>\\n <div><strong>Requirement:</strong> \${n.required}</div>\\n </div>\\n \`),\`\\n <div class="uw-a11y-details-item">\\n <div class="uw-a11y-details-label">\${e.label}:</div>\\n <div class="uw-a11y-details-value">\${n}</div>\\n </div>\\n \`}).join("")},groupIssuesByRule:function(e){const n={};return e.forEach(e=>{const t=e.ruleId||e.title.toLowerCase().replace(/[^a-z0-9]/g,"-");n[t]||(n[t]=[]),n[t].push(e)}),n},currentInstances:{},navigateInstance:function(e,n){this.currentInstances[e]||(this.currentInstances[e]=0);const t=this.groupIssuesByRule(this.issues)[e];if(!t)return;const i=this.currentInstances[e]+n;i>=0&&t.length>i&&(this.currentInstances[e]=i,this.updateInstanceDisplay(e,t),this.highlightCurrentInstance(e))},updateInstanceDisplay:function(e,n){const t=this.currentInstances[e]||0,i=n[t],a=document.getElementById(\`description-\${e}\`),o=document.getElementById(\`recommendation-\${e}\`),s=document.getElementById(\`current-\${e}\`),r=document.getElementById(\`detailed-content-\${e}\`);a&&(a.textContent=i.description.split("\\n")[0]),o&&(o.innerHTML=i.recommendation),s&&(s.textContent=t+1),r&&i.detailedInfo&&(r.innerHTML=this.renderDetailedInfo(i.detailedInfo));const l=document.getElementById(\`prev-\${e}\`),d=document.getElementById(\`next-\${e}\`);l&&(l.disabled=0===t),d&&(d.disabled=t===n.length-1)},highlightCurrentInstance:function(e){document.querySelectorAll(".uw-a11y-highlight").forEach(e=>{e.classList.remove("uw-a11y-highlight")});const n=this.groupIssuesByRule(this.issues)[e];if(!n)return;const t=n[this.currentInstances[e]||0];t.element&&(t.element.classList.add("uw-a11y-highlight"),t.element.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{t.element&&t.element.classList.remove("uw-a11y-highlight")},3e3))},isRuleVerified:function(e){const n=this.groupIssuesByRule(this.issues)[e];return!!n&&n.every(e=>e.uniqueId&&this.checkedItems.has(e.uniqueId))},toggleRuleVerification:function(e){const n=this.groupIssuesByRule(this.issues)[e];if(!n)return;const t=this.isRuleVerified(e);n.forEach(e=>{e.uniqueId&&(t?this.checkedItems.delete(e.uniqueId):this.checkedItems.add(e.uniqueId))});const i=document.getElementById(\`check-\${e}\`),a=i?.parentNode.querySelector(".uw-a11y-check-label"),o=document.getElementById(\`issue-\${e}\`),s=this.isRuleVerified(e);i&&(i.checked=s),a&&(a.textContent=s?\`All \${n.length} instances manually verified ‚úì\`:\`Mark all \${n.length} instances as verified\`),o&&(s?o.classList.add("checked"):o.classList.remove("checked")),this.updateScore(),sessionStorage.setItem("uw-a11y-checked",JSON.stringify(Array.from(this.checkedItems)))},toggleDetails:function(e){const n=document.getElementById(\`details-\${e}\`),t=n.previousElementSibling;n.classList.contains("expanded")?(n.classList.remove("expanded"),this.updateButtonText(t,"Show technical details")):(n.classList.add("expanded"),this.updateButtonText(t,"Hide technical details"))},updateButtonText:function(e,n){const t=e.childNodes;for(let e=t.length-1;e>=0;e--){const i=t[e];if(i.nodeType===Node.TEXT_NODE&&i.textContent.trim())return void(i.textContent=n)}e.appendChild(document.createTextNode(n))},toggleManualCheck:function(e){this.checkedItems.has(e)?this.checkedItems.delete(e):this.checkedItems.add(e);const n=document.getElementById(\`check-\${e}\`),t=n.parentNode.querySelector(".uw-a11y-check-label"),i=n.closest(".uw-a11y-issue");this.checkedItems.has(e)?(t.textContent="Manually verified ‚úì",i.classList.add("checked")):(t.textContent="Mark as manually verified",i.classList.remove("checked")),this.updateScore(),sessionStorage.setItem("uw-a11y-checked",JSON.stringify(Array.from(this.checkedItems)))},updateScore:function(){if(!this.filteredAxeResults)return;const e=this.calculateAccessibilityScore(this.filteredAxeResults);this.axeResults.score=e;const n=document.querySelector(".uw-a11y-score-number"),t=document.querySelector(".uw-a11y-score-circle");if(n&&t){n.textContent=e.score;const i=e.score,a=i/100*360;t.style.background=\`conic-gradient(from 0deg, \${90>i?70>i?50>i?"#dc3545":"#fd7e14":"#ffc107":"#28a745"} 0deg \${a}deg, #e9ecef \${a}deg 360deg)\`}const i=this.issues.filter(e=>"error"===e.type).length,a=this.issues.filter(e=>"warning"===e.type&&e.uniqueId).length,o=this.issues.filter(e=>"warning"===e.type&&e.uniqueId&&this.checkedItems.has(e.uniqueId)).length,s=document.getElementById("uw-a11y-summary");if(s){const e=s.querySelector('div[style*="margin: 8px 0"]');e&&(e.innerHTML=\`\\n <span class="uw-a11y-count count-error">\${i}</span>Violations\\n <span class="uw-a11y-count count-warning">\${a}</span>Manual Review\\n \${o>0?\`<span class="uw-a11y-count count-verified">\${o}</span>Verified\`:""}\\n \`)}},loadCheckedItems:function(){try{const e=sessionStorage.getItem("uw-a11y-checked");e&&(this.checkedItems=new Set(JSON.parse(e)))}catch(e){console.warn("Could not load checked items from sessionStorage:",e)}},toggleMinimize:function(){const e=document.getElementById("uw-a11y-panel"),n=document.getElementById("uw-a11y-minimize");e&&n&&(this.isMinimized=!this.isMinimized,this.isMinimized?(e.classList.add("minimized"),n.textContent="+",n.title="Restore"):(e.classList.remove("minimized"),n.textContent="‚àí",n.title="Minimize"),sessionStorage.setItem("uw-a11y-minimized",this.isMinimized))},loadMinimizeState:function(){try{"true"===sessionStorage.getItem("uw-a11y-minimized")&&setTimeout(()=>{this.toggleMinimize()},100)}catch(e){console.warn("Could not load minimize state from sessionStorage:",e)}},checkForUpdates:function(){sessionStorage.getItem("uw-a11y-update-checked")||(sessionStorage.setItem("uw-a11y-update-checked","true"),fetch("https://api.github.com/repos/althe3rd/Pinpoint/releases/latest").then(e=>e.json()).then(e=>{const n=e.tag_name.replace("v","");this.compareVersions(n,this.version)>0&&this.showUpdateNotification(n,e.html_url)}).catch(e=>{console.log("Update check failed:",e)}))},compareVersions:function(e,n){const t=e.split(".").map(Number),i=n.split(".").map(Number);for(let e=0;e<Math.max(t.length,i.length);e++){const n=t[e]||0,a=i[e]||0;if(n>a)return 1;if(a>n)return-1}return 0},showUpdateNotification:function(e,n){const t=document.createElement("div");t.id="uw-a11y-update-notification",t.innerHTML=\`\\n <div style="background: #28a745; color: white; padding: 10px; border-radius: 4px; margin-bottom: 10px; font-size: 13px;">\\n <strong>Update Available!</strong><br>\\n A new version (v\${e}) of the Pinpoint Accessibility Checker is available.<br>\\n Current version: v\${this.version}<br>\\n <div style="margin-top: 8px;">\\n <a href="\${n}" target="_blank" style="color: #ffffff; text-decoration: underline;">\\n View release notes ‚Üí\\n </a>\\n <span style="margin: 0 8px;">|</span>\\n <a href="https://althe3rd.github.io/Pinpoint/" target="_blank" style="color: #ffffff; text-decoration: underline;">\\n Get latest bookmarklet ‚Üí\\n </a>\\n <button onclick="this.parentElement.parentElement.style.display='none'" \\n style="float: right; background: none; border: 1px solid white; color: white; border-radius: 2px; padding: 2px 6px; cursor: pointer; font-size: 11px;">\\n ‚úï\\n </button>\\n </div>\\n </div>\\n \`,setTimeout(()=>{const e=document.getElementById("uw-a11y-summary");e&&e.insertBefore(t,e.firstChild)},500)},remove:function(){const e=document.getElementById("uw-a11y-panel");e&&e.remove();const n=document.getElementById("uw-a11y-styles");n&&n.remove(),document.querySelectorAll(".uw-a11y-highlight").forEach(e=>{e.classList.remove("uw-a11y-highlight")}),delete window.uwAccessibilityChecker}},window.uwAccessibilityChecker.init())}();`;
        
        // Set up the bookmarklet link
        document.addEventListener('DOMContentLoaded', function() {
            const bookmarkletLink = document.getElementById('bookmarklet-link');
            bookmarkletLink.href = 'javascript:' + bookmarkletCode;
        });
        
        // Generate bookmarklet code for copy/paste
        function generateBookmarklet() {
            const codeDiv = document.getElementById('bookmarklet-code');
            codeDiv.textContent = 'javascript:' + bookmarkletCode;
            codeDiv.classList.remove('hidden');
            
            // Select the text for easy copying
            const range = document.createRange();
            range.selectNode(codeDiv);
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
        }
    </script>
</body>
</html>