<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pinpoint Bookmarklet</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
            min-height: 100vh;
        }
        
        .header {
            background: #c5050c;
            color: white;
            padding: 2rem 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .card {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border-left: 4px solid #c5050c;
        }
        
        .card h2 {
            color: #c5050c;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }
        
        .card h3 {
            color: #333;
            margin: 1.5rem 0 1rem 0;
            font-size: 1.2rem;
        }
        
        .bookmarklet-container {
            background: #f8f9fa;
            border: 2px dashed #c5050c;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            text-align: center;
        }
        
        .bookmarklet {
            display: inline-block;
            background: #c5050c;
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 6px;
            font-weight: bold;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            cursor: grab;
            margin: 0.5rem;
        }
        
        .bookmarklet:hover {
            background: #a00408;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(197, 5, 12, 0.3);
        }
        
        .bookmarklet:active {
            cursor: grabbing;
        }
        
        .generate-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0.5rem;
        }
        
        .generate-btn:hover {
            background: #218838;
            transform: translateY(-1px);
        }
        
        .instruction-list {
            background: #e3f2fd;
            border-radius: 6px;
            padding: 1.5rem;
            margin: 1rem 0;
        }
        
        .instruction-list ol {
            padding-left: 1.5rem;
        }
        
        .instruction-list li {
            margin-bottom: 0.8rem;
            font-weight: 500;
        }
        
        .alert {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .alert.info {
            background: #d1ecf1;
            border-color: #bee5eb;
            color: #0c5460;
        }
        
        .alert.success {
            background: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        
        .footer {
            background: #333;
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 3rem;
        }
        
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        .hidden {
            display: none;
        }
        
        .code-display {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 1rem;
            border-radius: 5px;
            font-family: monospace;
            font-size: 0.9rem;
            margin: 1rem 0;
            word-break: break-all;
            max-height: 200px;
            overflow-y: auto;
        }

        .feature-highlight {
            background: #e8f5e8;
            border: 1px solid #c3e6cb;
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .feature-highlight h4 {
            color: #155724;
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Pinpoint</h1>
        <p>Digital Accessibility Testing Tool</p>
    </div>
    
    <div class="container">
        <div class="card">
            <h2>About This Tool</h2>
            <p>Pinpoint is a bookmarklet powered by <strong>axe-core</strong>, the industry-standard accessibility testing engine. This tool provides comprehensive WCAG 2.1 AA compliance testing with a detailed sidebar showing violations, recommendations, and fix suggestions.</p>
            
            <div class="feature-highlight">
                <h4>New Enhanced Features!</h4>
                <ul>
                    <li><strong>Accessibility Score:</strong> Get an instant 0-100 accessibility rating</li>
                    <li><strong>Detailed Technical Information:</strong> Color values, line numbers, and CSS selectors</li>
                    <li><strong>Expandable Details:</strong> Click "Show details" on any issue for in-depth information</li>
                    <li><strong>Visual Score Indicator:</strong> Color-coded circular progress indicator</li>
                </ul>
            </div>
            
            <div class="alert info">
                <strong>Powered by axe-core:</strong> Uses the same accessibility testing engine that powers popular tools throughout the industry, ensuring consistent and accurate results.
            </div>
        </div>
        
        <div class="card">
            <h2>Get Your Enhanced Bookmarklet</h2>
            
            <div class="bookmarklet-container">
                <h3>Option 1: Drag & Drop (Recommended)</h3>
                <p>Drag this button directly to your bookmarks bar:</p>
                <a href="#" id="bookmarklet-link" class="bookmarklet">Pinpoint A11y Checker</a>
                <p style="margin-top: 0.5rem; font-size: 0.9rem; color: #666;">
                    Right-click and "Bookmark this link" if drag & drop doesn't work
                </p>
            </div>
            
            <div class="bookmarklet-container">
                <h3>Option 2: Copy & Paste</h3>
                <p>Generate the bookmarklet code to copy manually:</p>
                <button class="generate-btn" onclick="generateBookmarklet()">Generate Enhanced Bookmarklet Code</button>
                <div id="bookmarklet-code" class="code-display hidden"></div>
                <p style="margin-top: 0.5rem; font-size: 0.9rem; color: #666;">
                    Copy this code and paste it as the URL when creating a new bookmark
                </p>
            </div>
            
            <div class="instruction-list">
                <h3>Installation Steps:</h3>
                <ol>
                    <li><strong>Show bookmarks bar:</strong> Press <code>Ctrl+Shift+B</code> (Windows) or <code>Cmd+Shift+B</code> (Mac)</li>
                    <li><strong>Add bookmark:</strong> Either drag the button above OR copy the generated code and create a new bookmark</li>
                    <li><strong>Name it:</strong> "Pinpoint A11y Checker" when creating the bookmark</li>
                    <li><strong>Test it:</strong> Visit any webpage and click your new bookmark</li>
                </ol>
            </div>
            
            <div class="alert success">
                <strong>Ready to use!</strong> The enhanced bookmarklet now shows an accessibility score, detailed technical information, and improved issue analysis.
            </div>
        </div>
        
        <div class="card">
            <h2>What You'll Get</h2>
            <ul style="padding-left: 1.5rem; margin: 1rem 0;">
                <li><strong>Accessibility Score:</strong> 0-100 rating with color-coded visual indicator</li>
                <li><strong>Detailed Sidebar:</strong> Professional interface showing all accessibility issues</li>
                <li><strong>Technical Details:</strong> HTML source, line numbers, CSS selectors, and color information</li>
                <li><strong>Violations & Warnings:</strong> Clear categorization of must-fix issues vs. manual review items</li>
                <li><strong>Click-to-Highlight:</strong> Click any issue to highlight the problematic element on the page</li>
                <li><strong>Enhanced Color Information:</strong> See actual foreground/background colors and contrast ratios</li>
                <li><strong>Fix Recommendations:</strong> Specific guidance on how to resolve each issue</li>
                <li><strong>WCAG Compliance:</strong> Tests against WCAG 2.1 AA standards</li>
                <li><strong>Impact Levels:</strong> Issues categorized by severity (critical, serious, moderate, minor)</li>
                <li><strong>Learn More Links:</strong> Direct links to axe-core documentation for each rule</li>
            </ul>
        </div>
        
        <div class="card">
            <h2>For Local Development</h2>
            <div class="alert">
                <strong>Testing Locally?</strong> If you're testing on localhost or file:// URLs, the CDN version might not work due to CORS restrictions. For local development, consider setting up a local web server.
            </div>
            
            <p><strong>Quick local server options:</strong></p>
            <ul style="padding-left: 1.5rem; margin: 0.5rem 0;">
                <li>Python: <code>python -m http.server 8000</code></li>
                <li>Node.js: <code>npx http-server</code></li>
                <li>PHP: <code>php -S localhost:8000</code></li>
            </ul>
        </div>
        
        <div class="card">
            <h2>Best Practices</h2>
            <ul style="padding-left: 1.5rem;">
                <li>Run accessibility checks on all pages before publishing</li>
                <li>Aim for scores of 90+ for excellent accessibility</li>
                <li>Fix all violations and address manual review items</li>
                <li>Use the detailed technical information to understand issues better</li>
                <li>Test keyboard navigation manually</li>
                <li>Verify with screen readers when possible</li>
                <li>Remember: automated testing catches ~30% of issues - manual testing is still essential</li>
            </ul>
        </div>
    </div>
    
    <div class="footer">
        
        <p style="margin-top: 1rem; font-size: 0.9rem; opacity: 0.8;">
            Powered by axe-core accessibility testing engine
        </p>
    </div>
    
    <script>
        // The enhanced bookmarklet code with scoring and detailed information
        const bookmarkletCode = `(function(){'use strict';if(window.uwAccessibilityChecker){window.uwAccessibilityChecker.remove();return;}window.uwAccessibilityChecker={issues:[],axeLoaded:false,init:function(){this.showLoadingPanel();this.loadAxeCore();},showLoadingPanel:function(){var panel=document.createElement('div');panel.id='uw-a11y-panel';panel.innerHTML='<div id="uw-a11y-header"><h2>Pinpoint</h2><button id="uw-a11y-close">×</button></div><div id="uw-a11y-content"><div style="text-align: center; padding: 2rem;"><div class="uw-a11y-spinner"></div><p style="margin-top: 1rem;">Loading axe-core accessibility engine...</p><p style="font-size: 0.9rem; color: #666;">This may take a few seconds on first use.</p></div></div>';this.addStyles();document.body.appendChild(panel);var self=this;document.getElementById('uw-a11y-close').onclick=function(){self.remove();};},loadAxeCore:function(){if(window.axe){this.axeLoaded=true;this.runAxeChecks();return;}var script=document.createElement('script');var self=this;script.src='https://cdn.jsdelivr.net/npm/axe-core@4.8.2/axe.min.js';script.onload=function(){self.axeLoaded=true;self.runAxeChecks();};script.onerror=function(){self.showError('Failed to load axe-core. Please check your internet connection and try again.');};document.head.appendChild(script);},runAxeChecks:function(){if(!window.axe){this.showError('axe-core failed to load properly.');return;}var axeConfig={rules:{},tags:['wcag2a','wcag2aa','wcag21aa']};var self=this;window.axe.run(document,axeConfig,function(err,results){if(err){self.showError('Error running accessibility analysis: '+err.message);return;}self.processAxeResults(results);self.displayResults();});},processAxeResults:function(results){this.issues=[];var self=this;results.violations.forEach(function(violation){violation.nodes.forEach(function(node){self.addIssue('error',violation.description,self.buildDescription(violation,node),self.getElementFromNode(node),self.buildRecommendation(violation),violation.helpUrl,violation.impact||'serious',violation.tags,self.buildDetailedInfo(violation,node));});});results.incomplete.forEach(function(incomplete){incomplete.nodes.forEach(function(node){self.addIssue('warning',incomplete.description,'Manual review needed: '+self.buildDescription(incomplete,node),self.getElementFromNode(node),self.buildRecommendation(incomplete),incomplete.helpUrl,incomplete.impact||'moderate',incomplete.tags,self.buildDetailedInfo(incomplete,node));});});this.axeResults={url:results.url,timestamp:results.timestamp,violations:results.violations.length,passes:results.passes.length,incomplete:results.incomplete.length,inapplicable:results.inapplicable.length,score:this.calculateScore(results)};},calculateScore:function(results){var w={critical:10,serious:7,moderate:3,minor:1};var d=0,t=results.passes.length+results.violations.length+results.incomplete.length;results.violations.forEach(function(v){d+=(v.nodes.length*(w[v.impact]||w.moderate));});results.incomplete.forEach(function(i){d+=(i.nodes.length*(w[i.impact]||w.moderate)*0.5);});if(t===0)return{score:100};var m=t*w.critical;var s=Math.max(0,Math.round(100-(d/m)*100));return{score:s,deductions:d,maxPossible:m};},buildDetailedInfo:function(rule,node){var details=[];if(node.html){details.push({label:'HTML Source',value:node.html});var lineNum=this.estimateLineNumber(node.html);if(lineNum>0)details.push({label:'Approximate Line',value:lineNum});}if(node.target&&node.target[0])details.push({label:'CSS Selector',value:node.target[0]});if(rule.id==='color-contrast'){var colorInfo=this.extractColorInfo(node);if(colorInfo)details.push({label:'Color Information',value:colorInfo});}if(node.failureSummary)details.push({label:'Technical Details',value:node.failureSummary});return details;},estimateLineNumber:function(htmlSnippet){try{var docHTML=document.documentElement.outerHTML;var index=docHTML.indexOf(htmlSnippet.substring(0,50));if(index>-1){var before=docHTML.substring(0,index);return before.split('\\n').length;}}catch(e){}return 0;},extractColorInfo:function(node){try{var el=this.getElementFromNode(node);if(!el)return null;var styles=window.getComputedStyle(el);var fg=styles.color;var bg=styles.backgroundColor;return'Foreground: '+fg+', Background: '+bg+' (WCAG AA requires 4.5:1 for normal text)';}catch(e){return null;}},buildDescription:function(rule,node){var description=rule.help||rule.description;if(node.failureSummary){description+='\\n\\nDetails: '+node.failureSummary;}if(node.html){description+='\\n\\nElement: '+node.html.substring(0,100);if(node.html.length>100)description+='...';}return description;},buildRecommendation:function(rule){return rule.help||'Please refer to the help documentation for specific guidance on fixing this issue.';},getElementFromNode:function(node){if(node.target&&node.target.length>0){try{return document.querySelector(node.target[0]);}catch(e){return null;}}return null;},showError:function(message){var panel=document.getElementById('uw-a11y-panel');if(panel){var content=panel.querySelector('#uw-a11y-content');content.innerHTML='<div class="uw-a11y-issue error" style="margin: 1rem;"><h4>Error Loading Accessibility Checker</h4><p>'+message+'</p><p><strong>Suggestions:</strong></p><ul><li>Check your internet connection</li><li>Try refreshing the page and running the bookmarklet again</li><li>Ensure your browser allows loading external scripts</li></ul></div>';}},createPanel:function(){var panel=document.getElementById('uw-a11y-panel');if(!panel){panel=document.createElement('div');panel.id='uw-a11y-panel';document.body.appendChild(panel);}panel.innerHTML='<div id="uw-a11y-header"><h2>Pinpoint</h2><button id="uw-a11y-close">×</button></div><div id="uw-a11y-content"><div id="uw-a11y-summary"></div><div id="uw-a11y-results"></div></div>';var self=this;document.getElementById('uw-a11y-close').onclick=function(){self.remove();};return panel;},addStyles:function(){if(document.getElementById('uw-a11y-styles'))return;var style=document.createElement('style');style.id='uw-a11y-styles';style.textContent='#uw-a11y-panel{position:fixed;top:20px;right:20px;width:450px;max-height:85vh;background:#ffffff;border:3px solid #c5050c;border-radius:8px;box-shadow:0 8px 32px rgba(0,0,0,0.3);z-index:999999;font-family:Arial,sans-serif;font-size:14px;overflow:hidden;}#uw-a11y-header{background:#c5050c;color:white;padding:12px 16px;display:flex;justify-content:space-between;align-items:center;}#uw-a11y-header h2{margin:0;font-size:16px;font-weight:bold;}#uw-a11y-close{background:none;border:none;color:white;font-size:18px;cursor:pointer;padding:0;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;}#uw-a11y-close:hover{background:rgba(255,255,255,0.2);}#uw-a11y-content{max-height:calc(85vh - 60px);overflow-y:auto;padding:16px;}#uw-a11y-summary{background:#f8f9fa;border:1px solid #dee2e6;border-radius:4px;padding:12px;margin-bottom:16px;}.uw-a11y-issue{margin-bottom:12px;padding:12px;border-left:4px solid #ffc107;background:#fff3cd;border-radius:0 4px 4px 0;cursor:pointer;}.uw-a11y-issue.error{border-left-color:#dc3545;background:#f8d7da;}.uw-a11y-issue.warning{border-left-color:#ffc107;background:#fff3cd;}.uw-a11y-issue.info{border-left-color:#17a2b8;background:#d1ecf1;}.uw-a11y-issue h4{margin:0 0 8px 0;font-size:14px;font-weight:bold;}.uw-a11y-issue p{margin:4px 0;line-height:1.4;}.uw-a11y-issue .issue-meta{font-size:12px;color:#666;margin-top:8px;padding-top:8px;border-top:1px solid rgba(0,0,0,0.1);}.uw-a11y-issue .learn-more{color:#c5050c;text-decoration:none;font-size:12px;}.uw-a11y-issue .learn-more:hover{text-decoration:underline;}.uw-a11y-highlight{background:yellow !important;border:2px solid red !important;box-shadow:0 0 0 2px yellow !important;}.uw-a11y-count{font-weight:bold;padding:2px 8px;border-radius:12px;color:white;font-size:12px;margin-right:8px;}.count-error{background:#dc3545;}.count-warning{background:#ffc107;color:#212529;}.count-info{background:#17a2b8;}.uw-a11y-spinner{width:40px;height:40px;border:4px solid #f3f3f3;border-top:4px solid #c5050c;border-radius:50%;animation:uw-spin 1s linear infinite;margin:0 auto;}@keyframes uw-spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}.axe-summary{font-size:12px;color:#666;border-top:1px solid #dee2e6;padding-top:12px;margin-top:12px;}.uw-a11y-score{text-align:center;margin:1rem 0;padding:1rem;background:#f8f9fa;border-radius:8px;border:2px solid #e9ecef;}.uw-a11y-score-circle{width:80px;height:80px;border-radius:50%;margin:0 auto 0.5rem;display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:bold;color:white;}.uw-a11y-details{margin-top:0.5rem;padding:0.5rem;background:#f1f3f4;border-left:3px solid #007cba;border-radius:0 4px 4px 0;font-size:11px;display:none;}.uw-a11y-details.show{display:block;}.uw-a11y-toggle{background:none;border:none;color:#007cba;cursor:pointer;font-size:11px;text-decoration:underline;padding:0;margin-top:0.5rem;}';document.head.appendChild(style);},addIssue:function(type,title,description,element,recommendation,helpUrl,impact,tags,detailedInfo){this.issues.push({type:type,title:title,description:description,element:element,recommendation:recommendation,helpUrl:helpUrl,impact:impact,tags:tags||[],detailedInfo:detailedInfo||[]});},displayResults:function(){var panel=this.createPanel();var summary=document.getElementById('uw-a11y-summary');var results=document.getElementById('uw-a11y-results');var counts={error:this.issues.filter(function(i){return i.type==='error';}).length,warning:this.issues.filter(function(i){return i.type==='warning';}).length};var score=this.axeResults?this.axeResults.score.score:0;var scoreColor=score>=90?'#28a745':score>=70?'#ffc107':score>=50?'#fd7e14':'#dc3545';summary.innerHTML=(this.axeResults?'<div class="uw-a11y-score"><div class="uw-a11y-score-circle" style="background:'+scoreColor+';">'+score+'</div><div><strong>Accessibility Score:</strong> '+score+'/100</div><div style="font-size:12px;color:#666;">'+(score>=90?'Excellent!':score>=70?'Good':score>=50?'Fair':'Needs improvement')+'</div></div>':'')+'<h3>axe-core Accessibility Analysis</h3><p><strong>Total Issues Found:</strong> '+this.issues.length+'</p><div style="margin: 8px 0;"><span class="uw-a11y-count count-error">'+counts.error+'</span>Violations <span class="uw-a11y-count count-warning">'+counts.warning+'</span>Manual Review</div><p><small>Click on any issue to highlight the element on the page.</small></p>'+(this.axeResults?'<div class="axe-summary"><strong>Test Summary:</strong> '+this.axeResults.violations+' violations, '+this.axeResults.passes+' passes, '+this.axeResults.incomplete+' need review, '+this.axeResults.inapplicable+' not applicable<br><strong>Standard:</strong> WCAG 2.1 AA | <strong>Engine:</strong> axe-core</div>':'');if(this.issues.length===0){results.innerHTML='<div class="uw-a11y-issue info"><h4>Excellent Accessibility!</h4><p>No accessibility violations detected by axe-core. Your page meets WCAG 2.1 AA automated testing standards.</p><p><strong>Next Steps:</strong> Consider manual testing with screen readers and keyboard navigation for complete accessibility validation.</p></div>';}else{var self=this;results.innerHTML=this.issues.map(function(issue,index){var detailsHtml='';if(issue.detailedInfo&&issue.detailedInfo.length>0){detailsHtml='<button class="uw-a11y-toggle" onclick="window.uwAccessibilityChecker.toggleDetails('+index+'); event.stopPropagation();">Show details</button><div class="uw-a11y-details" id="details-'+index+'">'+issue.detailedInfo.map(function(d){return '<div><strong>'+d.label+':</strong> '+d.value+'</div>';}).join('')+'</div>';}return '<div class="uw-a11y-issue '+issue.type+'" onclick="window.uwAccessibilityChecker.highlightElement('+index+')" style="cursor: '+(issue.element?'pointer':'default')+'"><h4>'+issue.title+'</h4><p>'+issue.description.split('\\n')[0]+'</p><p><strong>How to fix:</strong> '+issue.recommendation+'</p>'+detailsHtml+'<div class="issue-meta"><strong>Impact:</strong> '+(issue.impact||'unknown')+' | <strong>Tags:</strong> '+issue.tags.join(', ')+(issue.helpUrl?'<br><a href="'+issue.helpUrl+'" target="_blank" class="learn-more">Learn more about this rule</a>':'')+'</div></div>';}).join('');}},toggleDetails:function(index){var details=document.getElementById('details-'+index);var button=details.previousElementSibling;if(details.classList.contains('show')){details.classList.remove('show');button.textContent='Show details';}else{details.classList.add('show');button.textContent='Hide details';}},highlightElement:function(issueIndex){document.querySelectorAll('.uw-a11y-highlight').forEach(function(el){el.classList.remove('uw-a11y-highlight');});var issue=this.issues[issueIndex];if(issue.element){issue.element.classList.add('uw-a11y-highlight');issue.element.scrollIntoView({behavior:'smooth',block:'center'});setTimeout(function(){if(issue.element){issue.element.classList.remove('uw-a11y-highlight');}},3000);}},remove:function(){var panel=document.getElementById('uw-a11y-panel');if(panel)panel.remove();var styles=document.getElementById('uw-a11y-styles');if(styles)styles.remove();document.querySelectorAll('.uw-a11y-highlight').forEach(function(el){el.classList.remove('uw-a11y-highlight');});delete window.uwAccessibilityChecker;}};window.uwAccessibilityChecker.init();})();`;
        
        // Set up the bookmarklet link
        document.addEventListener('DOMContentLoaded', function() {
            const bookmarkletLink = document.getElementById('bookmarklet-link');
            bookmarkletLink.href = 'javascript:' + bookmarkletCode;
        });
        
        // Generate bookmarklet code for copy/paste
        function generateBookmarklet() {
            const codeDiv = document.getElementById('bookmarklet-code');
            codeDiv.textContent = 'javascript:' + bookmarkletCode;
            codeDiv.classList.remove('hidden');
            
            // Select the text for easy copying
            const range = document.createRange();
            range.selectNode(codeDiv);
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
        }
    </script>
</body>
</html>